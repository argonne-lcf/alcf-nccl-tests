Running on single node
I am 0 of 4: 0 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 3 of 4: 3 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 2 of 4: 2 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 1 of 4: 1 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
import time: 1.96485900
torch init time : 1.65224500
2.3.0
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages/torch/__init__.py
(2, 20, 5)
dist_my_rank = 0  dist_world_size = 4
[0-0] cuda:0
[0] Python: Elapsed time in each iter for broadcast: 2.70674900)
[0] Python: Elapsed time in each iter for broadcast: 0.00013900)
[0] Python: Elapsed time in each iter for broadcast: 0.00007300)
[0] Python: Elapsed time in each iter for broadcast: 0.00006800)
[0] Python: Elapsed time in each iter for broadcast: 0.00005600)
[0] Python: Elapsed time in each iter for broadcast: 0.00005500)
[0] Python: Elapsed time in each iter for broadcast: 0.00006800)
[0] Python: Elapsed time in each iter for broadcast: 0.00006800)
[0] Python: Elapsed time in each iter for broadcast: 0.00006900)
[0] Python: Elapsed time in each iter for broadcast: 0.00015300)
Average time for broadcast (exclude first iter): 0.00008322 
[0] Python: Elapsed time in each iter for all_reduce : 0.00199700)
[0] Python: Elapsed time in each iter for all_reduce : 0.00007700)
[0] Python: Elapsed time in each iter for all_reduce : 0.00014500)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006700)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006500)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006600)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006800)
[0] Python: Elapsed time in each iter for all_reduce : 0.00012500)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006400)
Average time for all_reduce (exclude first iter): 0.00008222 
[0] Python: Elapsed time in each iter for reduce : 0.00013300)
[0] Python: Elapsed time in each iter for reduce : 0.00008700)
[0] Python: Elapsed time in each iter for reduce : 0.00006200)
[0] Python: Elapsed time in each iter for reduce : 0.00006300)
[0] Python: Elapsed time in each iter for reduce : 0.00006300)
[0] Python: Elapsed time in each iter for reduce : 0.00006000)
[0] Python: Eldist_my_rank = 2  dist_world_size = 4
[2-2] cuda:2
apsed time in each iter for reduce : 0.00006100)
[0] Python: Elapsed time in each iter for reduce : 0.00006300)
[0] Python: Elapsed time in each iter for reduce : 0.00006500)
[0] Python: Elapsed time in each iter for reduce : 0.00006100)
Average time for all_reduce (exclude first iter): 0.00006500 
[0] Python: Elapsed time in each iter for all_gather : 0.00025700)
[0] Python: Elapsed time in each iter for all_gather : 0.00011400)
[0] Python: Elapsed time in each iter for all_gather : 0.00010600)
[0] Python: Elapsed time in each iter for all_gather : 0.00010600)
[0] Python: Elapsed time in each iter for all_gather : 0.00010200)
[0] Python: Elapsed time in each iter for all_gather : 0.00010400)
[0] Python: Elapsed time in each iter for all_gather : 0.00010200)
[0] Python: Elapsed time in each iter for all_gather : 0.00010600)
[0] Python: Elapsed time in each iter for all_gather : 0.00010300)
[0] Python: Elapsed time in each iter for all_gather : 0.00010100)
Average time for all_gather (exclude first iter): 0.00006500 
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00007000)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005300)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005000)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004800)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004700)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005200)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004700)
Average time for reduce_scatter (exclude first iter): 0.00004933 
[0] Python: Elapsed time in each iter for all_to_all : 0.43303500)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006800)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005600)
[0] Python: Elapsed time in each iter dist_my_rank = 1  dist_world_size = 4
[1-1] cuda:1
dist_my_rank = 3  dist_world_size = 4
[3-3] cuda:3
for all_to_all : 0.00005600)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005400)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005400)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005200)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005400)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005300)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005200)
Average time for all_to_all (exclude first iter): 0.00005544 
-------------------------------
Running on two nodes with 1 rank per node
I am 1 of 2: 0 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 0 of 2: 0 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
dist_my_rank = 1  dist_world_size = 2
[1-0] cuda:0
import time: 2.98635500
torch init time : 0.98867200
2.3.0
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages/torch/__init__.py
(2, 20, 5)
dist_my_rank = 0  dist_world_size = 2
[0-0] cuda:0
[0] Python: Elapsed time in each iter for broadcast: 0.24530400)
[0] Python: Elapsed time in each iter for broadcast: 0.00006500)
[0] Python: Elapsed time in each iter for broadcast: 0.00005600)
[0] Python: Elapsed time in each iter for broadcast: 0.00005900)
[0] Python: Elapsed time in each iter for broadcast: 0.00005500)
[0] Python: Elapsed time in each iter for broadcast: 0.00005500)
[0] Python: Elapsed time in each iter for broadcast: 0.00005500)
[0] Python: Elapsed time in each iter for broadcast: 0.00005800)
[0] Python: Elapsed time in each iter for broadcast: 0.00005200)
[0] Python: Elapsed time in each iter for broadcast: 0.00006500)
Average time for broadcast (exclude first iter): 0.00005778 
[0] Python: Elapsed time in each iter for all_reduce : 0.00070300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00007100)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006400)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006200)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006100)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006500)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006000)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006500)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006100)
[0] Python: Elapsed time in each iter for all_reduce : 0.00005900)
Average time for all_reduce (exclude first iter): 0.00006311 
[0] Python: Elapsed time in each iter for reduce : 0.00007200)
[0] Python: Elapsed time in each iter for reduce : 0.00005900)
[0] Python: Elapsed time in each iter for reduce : 0.00006000)
[0] Python: Elapsed time in each iter for reduce : 0.00005800)
[0] Python: Elapsed time in each iter for reduce : 0.00005800)
[0] Python: Elapsed time in each iter for reduce : 0.00005800)
[0] Python: Elapsed time in each iter for reduce : 0.00005600)
[0] Python: Elapsed time in each iter for reduce : 0.00007500)
[0] Python: Elapsed time in each iter for reduce : 0.00005800)
[0] Python: Elapsed time in each iter for reduce : 0.00005700)
Average time for all_reduce (exclude first iter): 0.00005989 
[0] Python: Elapsed time in each iter for all_gather : 0.00026200)
[0] Python: Elapsed time in each iter for all_gather : 0.00010100)
[0] Python: Elapsed time in each iter for all_gather : 0.00009600)
[0] Python: Elapsed time in each iter for all_gather : 0.00009500)
[0] Python: Elapsed time in each iter for all_gather : 0.00009400)
[0] Python: Elapsed time in each iter for all_gather : 0.00009300)
[0] Python: Elapsed time in each iter for all_gather : 0.00009200)
[0] Python: Elapsed time in each iter for all_gather : 0.00009400)
[0] Python: Elapsed time in each iter for all_gather : 0.00009100)
[0] Python: Elapsed time in each iter for all_gather : 0.00009000)
Average time for all_gather (exclude first iter): 0.00005989 
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00007000)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005500)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005200)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005100)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005300)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005000)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005000)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005300)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005000)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004800)
Average time for reduce_scatter (exclude first iter): 0.00005133 
[0] Python: Elapsed time in each iter for all_to_all : 0.01080500)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006100)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005700)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005400)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005300)
[0] Python: Elapsed time in each iter for all_to_all : 0.00007200)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005600)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005500)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005200)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005200)
Average time for all_to_all (exclude first iter): 0.00005689 
-------------------------------
Running on two nodes with 2 ranks per node
I am 0 of 4: 0 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 1 of 4: 1 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 2 of 4: 0 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 3 of 4: 1 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
import time: 3.21293300
torch init time : 0.95947500
2.3.0
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages/torch/__init__.py
(2, 20, 5)
dist_my_rank = 0  dist_world_size = 4
[0-0] cuda:0
[0] Python: Elapsed time in each iter for broadcast: 0.77831100)
[0] Python: Elapsed time in each iter for broadcast: 0.00007600)
[0] Python: Elapsed time in each iter for broadcast: 0.00006900)
[0] Python: Elapsed time in each iter for broadcast: 0.00016100)
[0] Python: Elapsed time in each iter for broadcast: 0.00006400)
[0] Python: Elapsed time in each iter for broadcast: 0.00006300)
[0] Python: Elapsed time in each iter for broadcast: 0.00006100)
[0] Python: Elapsed time in each iter for broadcast: 0.00006500)
[0] Python: Elapsed time in each iter for broadcast: 0.00005700)
[0] Python: Elapsed time in each iter for broadcast: 0.00005900)
Average time for broadcast (exclude first iter): 0.00007500 
[0] Python: Elapsed time in each iter for all_reduce : 0.00112800)
[0] Python: Elapsed time in each iter for all_reduce : 0.00007500)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006600)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006200)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006600)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006400)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006400)
Average time for all_reduce (exclude first iter): 0.00006511 
[0] Python: Elapsed time in each iter for reduce : 0.00007800)
[0] Python: Elapsed time in each iter for reduce : 0.00006200)
[0] Python: Elapsed time in each iter for reduce : 0.00006000)
[0] Python: Elapsed time in each iter for reduce : 0.00006100)
[0] Python: Elapsed time in each iter for reduce : 0.00006100)
[0] Python: Elapsed time in each iter for reduce : 0.00006000)
[0] Python: Elapsed time in each iter for reduce : 0.00006000)
[0] Python: Elapsed time in each iter for reduce : 0.00006200)
[0] Python: Elapsed time in each iter for reduce : 0.00006000)
[0] Python: Elapsed time in each iter for reduce : 0.00005800)
Average time for all_reduce (exclude first iter): 0.00006044 
[0] Python: Elapsed time in each iter for all_gather : 0.00026900)
[0] Python: Elapsed time in each iter for all_gather : 0.00011600)
[0] Python: Elapsed time in each iter for all_gather : 0.00010900)
[0] Python: Elapsed time in each iter for all_gather : 0.00010700)
[0] Python: Elapsed time in each iter for all_gather : 0.00010500)
[0] Python: Elapsed time in each iter for all_gather : 0.00010500)
[0] Python: Elapsed time in each iter for all_gather : 0.00010600)
[0] Python: Elapsed time in each iter for all_gather : 0.00010800)
[0] Python: Elapsed time in each iter for all_gather : 0.00010400)
[0] Python: Elapsed time in each iter for all_gather : 0.00010500)
Average time for all_gather (exclude first iter): 0.00006044 
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00007500)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005500)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005300)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005300)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005200)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005100)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005200)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005400)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005100)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005200)
Average time for reduce_scatter (exclude first iter): 0.00005256 
[0] Python: Elapsed time in each iter for all_to_all : 0.03393600)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006600)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005900)
[0] Python: Elapsed time in each iter dist_my_rank = 1  dist_world_size = 4
[1-1] cuda:1
dist_my_rank = 2  dist_world_size = 4
[2-0] cuda:0
dist_my_rank = 3  dist_world_size = 4
[3-1] cuda:1
for all_to_all : 0.00005800)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005700)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005900)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005700)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005800)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005700)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005600)
Average time for all_to_all (exclude first iter): 0.00005856 
-------------------------------
Running on two nodes with 4 ranks per node
I am 2 of 8: 2 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 0 of 8: 0 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 3 of 8: 3 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 1 of 8: 1 on x3200c0s7b0n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 5 of 8: 1 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 7 of 8: 3 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 6 of 8: 2 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
I am 4 of 8: 0 on x3200c0s7b1n0 - MASTER_ADDR=x3200c0s7b0n0.hsn.cm.sirius.alcf.anl.gov
dist_my_rank = 1  dist_world_size = 8
[1-1] cuda:1
dist_my_rank = 3  dist_world_size = 8
[3-3] cuda:3
dist_my_rank = 4  dist_world_size = 8
[4-0] cuda:0
dist_my_rank = 2  dist_world_size = 8
[2-2] cuda:2
dist_my_rank = 6  dist_world_size = 8
[6-2] cuda:2
dist_my_rank = 7  dist_world_size = 8
[7-3] cuda:3
dist_my_rank = 5  dist_world_size = 8
[5-1] cuda:1
import time: 3.44177100
torch init time : 0.98185000
2.3.0
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages/torch/__init__.py
(2, 20, 5)
dist_my_rank = 0  dist_world_size = 8
[0-0] cuda:0
[0] Python: Elapsed time in each iter for broadcast: 1.88771800)
[0] Python: Elapsed time in each iter for broadcast: 0.00014900)
[0] Python: Elapsed time in each iter for broadcast: 0.00010000)
[0] Python: Elapsed time in each iter for broadcast: 0.00006600)
[0] Python: Elapsed time in each iter for broadcast: 0.00005800)
[0] Python: Elapsed time in each iter for broadcast: 0.00015200)
[0] Python: Elapsed time in each iter for broadcast: 0.00014400)
[0] Python: Elapsed time in each iter for broadcast: 0.00006300)
[0] Python: Elapsed time in each iter for broadcast: 0.00005500)
[0] Python: Elapsed time in each iter for broadcast: 0.00005500)
Average time for broadcast (exclude first iter): 0.00009356 
[0] Python: Elapsed time in each iter for all_reduce : 0.00192000)
[0] Python: Elapsed time in each iter for all_reduce : 0.00007300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006300)
[0] Python: Elapsed time in each iter for all_reduce : 0.00005800)
[0] Python: Elapsed time in each iter for all_reduce : 0.00005900)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006000)
[0] Python: Elapsed time in each iter for all_reduce : 0.00005700)
[0] Python: Elapsed time in each iter for all_reduce : 0.00006200)
[0] Python: Elapsed time in each iter for all_reduce : 0.00007100)
[0] Python: Elapsed time in each iter for all_reduce : 0.00010000)
Average time for all_reduce (exclude first iter): 0.00006700 
[0] Python: Elapsed time in each iter for reduce : 0.00008700)
[0] Python: Elapsed time in each iter for reduce : 0.00006300)
[0] Python: Elapsed time in each iter for reduce : 0.00017000)
[0] Python: Elapsed time in each iter for reduce : 0.00008000)
[0] Python: Elapsed time in each iter for reduce : 0.00008400)
[0] Python: Elapsed time in each iter for reduce : 0.00005900)
[0] Python: Elapsed time in each iter for reduce : 0.00007200)
[0] Python: Elapsed time in each iter for reduce : 0.00007700)
[0] Python: Elapsed time in each iter for reduce : 0.00005900)
[0] Python: Elapsed time in each iter for reduce : 0.00005800)
Average time for all_reduce (exclude first iter): 0.00008022 
[0] Python: Elapsed time in each iter for all_gather : 0.00029500)
[0] Python: Elapsed time in each iter for all_gather : 0.00012800)
[0] Python: Elapsed time in each iter for all_gather : 0.00011800)
[0] Python: Elapsed time in each iter for all_gather : 0.00012000)
[0] Python: Elapsed time in each iter for all_gather : 0.00011500)
[0] Python: Elapsed time in each iter for all_gather : 0.00013600)
[0] Python: Elapsed time in each iter for all_gather : 0.00011800)
[0] Python: Elapsed time in each iter for all_gather : 0.00013600)
[0] Python: Elapsed time in each iter for all_gather : 0.00033900)
[0] Python: Elapsed time in each iter for all_gather : 0.00012200)
Average time for all_gather (exclude first iter): 0.00008022 
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00007400)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00005300)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004800)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004700)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004800)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004800)
[0] Python: Elapsed time in each iter for reduce_scatter : 0.00004900)
Average time for reduce_scatter (exclude first iter): 0.00004889 
[0] Python: Elapsed time in each iter for all_to_all : 0.14108000)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006600)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005900)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005600)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006700)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006000)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005500)
[0] Python: Elapsed time in each iter for all_to_all : 0.00006300)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005900)
[0] Python: Elapsed time in each iter for all_to_all : 0.00005800)
Average time for all_to_all (exclude first iter): 0.00006033 
