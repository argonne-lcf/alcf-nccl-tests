DDP: I am worker 1 of 8. My local rank is 1
DDP: I am worker 0 of 8. My local rank is 0
=> Dummy data is used!
start training
DDP: I am worker 2 of 8. My local rank is 2
DDP: I am worker 3 of 8. My local rank is 3
DDP: I am worker 6 of 8. My local rank is 2
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
DDP: I am worker 4 of 8. My local rank is 0
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
DDP: I am worker 5 of 8. My local rank is 1
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
DDP: I am worker 7 of 8. My local rank is 3
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/soft/applications/conda/2024-04-29/mconda3/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
Throughput: 2117.689 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.943 s, Average batch time: 0.069 s, First batch time: 0.959 s
start training
Throughput: 2072.868 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.346 s, Average batch time: 0.063 s, First batch time: 0.233 s
start training
Throughput: 2059.674 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.382 s, Average batch time: 0.063 s, First batch time: 0.229 s
start training
Throughput: 2086.328 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.298 s, Average batch time: 0.062 s, First batch time: 0.224 s
start training
Throughput: 2044.767 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.415 s, Average batch time: 0.064 s, First batch time: 0.218 s
start training
Throughput: 2011.711 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.531 s, Average batch time: 0.065 s, First batch time: 0.232 s
start training
Throughput: 2009.680 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.536 s, Average batch time: 0.065 s, First batch time: 0.230 s
start training
Throughput: 1786.674 images/s, Batch size: 16, Num of GPUs: 8, Total time: 7.322 s, Average batch time: 0.072 s, First batch time: 0.229 s
start training
Throughput: 2037.085 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.446 s, Average batch time: 0.064 s, First batch time: 0.225 s
start training
Throughput: 1957.240 images/s, Batch size: 16, Num of GPUs: 8, Total time: 6.702 s, Average batch time: 0.066 s, First batch time: 0.228 s
Total time: 66.3392448425293

Test set: Average loss: -0.0014, Accuracy: 6/50000 (0%)

